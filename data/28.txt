2015 IEEE International Conference on Big Data (Big Data)Visual Analysis of Bi-directional Movement BehaviorYixian Zheng∗, Wenchao Wu∗†, Huamin Qu∗, Chunyan Ma‡ and Lionel M. Ni§∗Department of Computer Science and Engineering, Hong Kong University of Science and Technology Email: {yzhengaj, wwuag, huamin}@cse.ust.hk‡Department of Software Engineering, Northwestern Polytechnical UniversityEmail: machunyan@nwpu.edu.cn§Department of Computer and Information Science, University of Macau Email: ni@umac.mo
  Abstract—The availability of massive volumes  of  trajectory  data has made it convenient for the study of different types of movement behaviors. Among them, bi-directional movement behaviors exist ubiq- uitously in our daily life, from urban trafﬁc to animal migration, and from sports to wars. To analyze bi-directional movement behaviors, people need to compare movements in two directions simultaneously for detecting similarities or differences in the movement patterns. If the movement involves tens of thousands items like vehicles or bird migration during a ten-year time span, the comparisons need to be done at both macro level and micro level. Due to the complexities of data and the challenges of analytical tasks, visual analytics is often used to take full advantage of machines’ computational power as well as human’s domain knowledge and cognitive abilities. In this paper, we present a comprehensive visual analytics system with three major visualization modules, including Global View, OD-pair Flow View and Isotime Storyline View, to depict bi-directional movement behaviors in a novel way, which enables a three-level exploration to help users gain insights into both macro and micro patterns. Quantitative analyses (e.g. movement model construction, modular  DoI  speciﬁcation  and key node extraction) and intuitive visualizations (e.g. parallelized ﬂow map, bidirectional storyline chart with contour map and multi-layer heat map) are integrated into our system to provide an efﬁcient and intuitive solution to the analysis of bi-directional movement behaviors based on big movement data. Case studies with two real-world datasets and expert interviews are carried out to demonstrate the effectiveness and usefulness of our system.  Keywords-bi-directional movement behavior; movement visualiza- tion; visual analytics; storyline chart; parallelized ﬂow map               I. INTRODUCTION  Movement behavior is a fundamental and important aspect of life. Many crucial scientiﬁc, societal and commercial decisions are made depending on proper knowledge and correct understanding of movement patterns of people, animals or objects. Fortunately, recent technological advances have increasingly made massive volume and high resolution movement data available and affordable for studies on different types of movement behaviors [1]. Among them, the bi-directional movement behavior is an important type which exists ubiquitously from urban trafﬁc to animal migration, and from sports to wars.  However, analyzing bi-directional movement behaviors is a challenging task. When investigating bi-directional movement be- haviors, patterns in two directions often need to be compared simultaneously. To make matters worse, real-world applications often involve a range of different analytical tasks on both macro patterns (i.e. characteristics of routes and Origin/Destination-pairs) and micro patterns (i.e. individual’s behaviors). Urban planners or† Wenchao Wu is the corresponding author.
administrators, for example, may need to analyze tens of thou- sands of vehicles trajectories to get an overview of bi-directional movement behaviors between a series of OD(Origin/Destination)- pairs, which helps them identify ﬂaws of urban planning and improve transport construction. Citizens might be curious about possible routes and corresponding trafﬁc conditions to and from the neighborhoods they live in, so that they can better schedule their trips and avoid congestions. In addition, a biologist observing animal migrations might try to compare bi-directional migration behaviors of individual animals during a ten-year time span.  To address these challenges, analysts seek the help of visual analytics to support various tasks in  the  real  world,  so  as  to take full advantage of machines’ computational power as well as human’s domain knowledge and cognitive abilities. In this paper, we propose a visual analytics system with three visualization modules, including Global View, OD-pair Flow View and Isotime Storyline View. To the best of our knowledge, this is the ﬁrst comprehensive visual analytics system of its kind that allows users to interactively analyze bi-directional movement behaviors with different levels of detail based on big movement data.The major contributions of this work are as follows:• The design and implementation of a comprehensive visual analytics system to investigate bi-directional movement be- haviors;• A novel movement model based on the modular degree-of- interest (DoI) speciﬁcation and the key node extraction method for modeling bi-directional movement behaviors;• Several novel visualization designs enhanced with new fea- tures including one bi-directional ﬂow map which linearizes routes in a parallel fashion and one extended storyline visu- alization with contour maps and isotime curves to facilitate a multi-perspective exploration;• Case studies based on two real-world datasets and interviews with three domain experts that demonstrate the usability and effectiveness of our system.II. RELATED  WORK  In this section, we brieﬂy discuss relevant research work on visualization of bi-directional movement behaviors, visual analytics of movement, storyline visualization as well as DoI speciﬁcation. Visualization  of  Bi-directional  Movement  Behaviors	Al- though bi-directional movement behaviors exist ubiquitously in our daily life, there are only a few studies exploiting advanced visualizations to analyze them. Charles Minard [2] drew the map of Napoleon’s disastrous Russian campaign of 1812 to indicate
Napoleon’s troops’ bi-directional military movement to and from Moscow along with spatial, temporal and some other attributes. We are inspired by this work and try to apply and extend the idea to general bi-directional movement behaviors and produce visu- alizations automatically for more complex analytical tasks. Flow map is widely used to show movement among different places. Andrienko et al. [1] presented a method for territory tessellation and made a ﬂow map to convey the aggregated two-way movement of cars in Milan among adjacent regions. Recently, Guo et al. [3] further improved the ﬂow map visualization by ﬂow smoothing and mapping to address the visual clutter problem. In addition, Ferreira et al. [4] proposed BirdVis to support the analysis of spatio- temporal bird distribution. However, all these methods fail to show the route information, nor can the micro-behavior of individuals along the route be explored, which is often essential for real-world applications. Crnovrsanin et al. [5] presented a proximity-based metaphor to visualize movement traces. However, as proximity- based visualizations imply a change in the frame of reference, ﬁnding a proper reference is not an easy task and should be determined based on the distribution of data and analytical tasks. In this paper, we try to conduct an in-depth and comprehensive study on general bi-directional movement behaviors based on intuitive visualizations and effective data modeling.  Visual Analytics of Movement Visualization of bi-directional movement behaviors falls into the general topic called visual ana- lytics of movement which has been extensively studied. Andrienko et al. [1] [6] summarized previous work systematically and cate- gorized related techniques into three major types: direct depiction, summarization and pattern extraction. We will brieﬂy discuss some representative works of each type in recent years. The direct depiction technique plots paths of movement directly. For example, movement can be represented as polylines [7] or stacked bands [8] on a map, in a space-time cube [9] or in a proximity space [5]. In order to depict temporal information, timeline visualization can also be integrated [10] [11]. Although this type of techniques can reveal the micro-behavior of individuals, the major issue that needs to be addressed is the visual clutter while handling large and complex datasets. The summarization technique is another common way to visualize movement based on statistical calculations. The basic idea is to aggregate the movement after dividing temporal and spatial domains into time intervals and space compartments. Meanwhile, relevant features can also be extracted and visualized with both temporal and geographic aggregation. For instance, density map [12], heat map [13], ﬂow map [3] and glyphs [14] [15] are widely used to present the summaries of movement. In most real-world applications, summarization techniques often need to be integrated with other techniques so as to support analysis at different granularity levels. The pattern extraction technique visualizes the hidden patterns extracted from movement data, such as interchange patterns [16] and group movement patterns [17]. In this paper, we propose a visual analytics approach focusing on bi- directional movement behaviors which combines three major types of movement visualization techniques for a series of analytical tasks requiring different levels of detail.  Storyline Visualization Storyline visualization is commonly employed to portray the dynamics of entity relationships. A pioneering work, namely “Movie  Narrative  Charts”,  was  done by Munroe [18], which represents each character as a line and
depicts the relationships between  the movie characters through the distances between the associated lines. Inspired by this work, a variety of techniques have been proposed based on storyline visualization for different applications, such as tracing temporal relationships in genealogical data [19], revealing the evolution of community structure in social networks [20], and investigating topic evolution in a text  stream  [21]  [22].  In  addition,  there are also some studies [23] [24] [25] on general approaches and algorithms for the generation of storyline. Inspired by these works, in our system, we adopt storyline visualization and enhance it with several new features. Advantages of storyline visualization are made full use of to explore micro patterns of bi-directional movement behaviors.  DoI Speciﬁcation   The “Degree-of-Interest” (DoI) function is a well-known concept in graph  analysis  [26],  which  quantiﬁes the interestingness of graph elements for users’ exploration in different application domains [27] [28]. Recently, Abello et al. [29] introduced a modular DoI speciﬁcation which provides an approach with comparable ﬂexibility to analyze large dynamic graphs. We adopt the DoI function into our system which we believe is a new expressive description for movement analysis. More details will be discussed in Section IV-B.III. OVERVIEWA. Data and Tasks  The data applied in our system is a series of trajectories, consisting of a set of sampling points. Each sampling point contains a record of position, time and other related attributes (e.g. speed, heading direction).  In this study, we are keenly interested in the bi-directional movement behaviors between a pair of regions (i.e. OD-pair) which is common in many practical applications. To better understand the problem domain and identify characteristics of bi-directional movement, we work closely with three domain experts who investi- gate topics related to bi-directional movement behaviors in different ﬁelds, including urban planning, transportation and trajectory data analysis. The extensive discussions gradually led to a set of basic analytical tasks at three levels that our system should support:• Global level: Given a set of trajectories,T.1 Extract and present OD-pairs with bi-directional move- ment behaviors in the data;• OD-pair level: Given a chosen OD-pair, region A and B,T.2 Present all routes from A to B and from B to A clearly;T.3 Investigate macro patterns in spatial, temporal and other attributes of routes, such as comparing the time spent among different routes, identifying popular routes in two directions;• Route level: Given a speciﬁc route selected by users,T.4 Examine each individual’s bi-directional movement be- haviors within context (i.e. aggregated patterns);T.5 Compare behaviors of different individuals as well as behaviors in two directions.B. System Overview  As shown in Fig. 1, our system consists of two phases: data modeling phase and visual analysis phase.  In the data modeling phase, after loading a set of trajectories, we ﬁrst construct the movement model in a graph-structure taking consideration of both spatial information and path existence. Based
on this model, the OD-pairs and their corresponding routes in two directions are extracted. After that, the DoI is calculated based on user’s speciﬁcation and the key nodes along the routes are detected. Details of this phase are presented in Section IV.  In the visual analysis phase, following the information seek- ing mantra “Overview ﬁrst, zoom and ﬁlter, then details on de- mand” [30], our system provides three major linked views. Users ﬁrst start with the Global View, which provides an overview of OD-pairs with diverse bi-directional movement behaviors. Users are free to explore any region on the map and choose two regions of their interest as an OD-pair for further exploration. Then, the OD- pair Flow View is provided to present all routes in two directions for the chosen OD-pair and to investigate the distribution of the spa- tial and mobility-related factors. Furthermore, if users are interested in a certain route, the Isotime Storyline View will visualize detailed information (e.g. time spent, speed) of individuals’ behaviors along the route and allow users to explore and compare the micro patterns in two directions within a certain time period. The Global View, the OD-pair Flow View and the Isotime Storyline View complement one another through interactions and provide an effective and comprehensive way to explore bi-directional movement behaviors from different aspects and at different scales.Figure 1: System framework.IV. MODELLING  BI-DIRECTIONAL  MOVEMENT  BEHAVIORIn  this  section,  we  describe  the  key  techniques  in  the  data
corresponding compartments without passing through others. After that, the weight of each edge is calculated based on geographical distance. Finally, we extract a sub-graph for each OD-pair in the data and group the corresponding trajectories into different routes. In this way, we organize the movement in a clear structure to support an interactive analysis of our system.B. DoI Deﬁnition  To extract important patterns of bi-directional movement be- haviors between an OD-pair, we adopt the idea of degree-of- interest (DoI) function to quantify the interestingness of nodes in the movement model. In  particular, we want to capture the diversity of movement behaviors which might lead to interesting patterns [13]. We work closely with our collaborators and deﬁne the comprehensive DoI function for general bi-directional movement behaviors based on a modular deﬁnition [29], which consists of speciﬁcation components, combination components and propaga- tion components.  Speciﬁcation Components  The speciﬁcation components cap- ture users’ interests based on attributes of nodes. For the sub-graph of the OD-pair, we extract all trajectories passing a certain node. As suggested by our domain experts, attributes in three aspects are considered. Note that, we especially consider movement directions in these aspects to investigate bi-directional movement behaviors. Spatial attributes: describe the movement on different routes.For each node, we count the number of trajectories passing the node along different routes in two directions.    Temporal attributes: depict the temporal distribution of move- ment. We divide the time period into time bins (e.g. 24 bins for a day, 60 bins for an hour). For each node, we count the number of trajectories passing the node during each time bin in two directions. Mobility-related  attributes:  demonstrate  the  distribution  of values of mobility-related attributes (e.g.  speed, time spent) of movement. We divide the range of attribute value into several bins.For each node, we count the number of trajectories passing the node with the attribute value falling into each bin in two directions.  Furthermore, for the diversity of the movement behaviors, we deﬁne the computation function comp() based on the entropy formula and the interest function inter() based on the sigmoid function. Thus, the speciﬁcation components for a certain node X can be deﬁned based on attributes attr described above (i.e. spatial, temporal or mobility-related attributes) as follows:
n	n
modeling  phase,  including  movement  model  construction,  DoIdeﬁnition and key node extraction.A. Movement Model Construction  The model is constructed to capture the topology and important patterns of movement for effective visualizations. We follow the aggregation method in [31] to deﬁne space compartments respect- ing the spatial distribution of the movement data. The method extracts characteristic points of trajectories, groups them by spatial proximity and generates Voronoi cells as compartments based on the centers of the groups. Then, we build up the movement model in the form of a graph G = (V, E) with space compartments as nodes in the set V . In order to reﬂect the actual distance between space compartments with respect to both geographical distance and path existence, we connect a pair of nodes to form an edge in the set E if and only if there is at least one trajectory connecting these two
spec(X)= inter(comp(attr)) = Sigmoid(−∑∑ i,dir ln( i,dir ))                                              dir  i	n	nwhere n is the total number of trajectories between the OD-pair. For a certain direction dir, ni,dir  is the number of trajectories inthe ith  route for spatial attributes, in the ith  time bin for temporalattributes, or in the ith bin of values for mobility-related attributes. Each speciﬁcation component spec(X) itself is already a simple DoI function doi(X). The remaining components further take themas inputs to yield more powerful DoI functions.  Combination Components The combination components in- tegrate several speciﬁcation components so as to deﬁne a com- prehensive DoI function satisfying users’ needs. In  our  sys- tem, we adopt weighted sum. Thus, speciﬁcation components in three aspects are summed up with their corresponding weightswspatial, wtemporal, wmobility  ∈ R+,  where  wspatial + wtemporal +
wmobility = 1. The weights can be speciﬁed by users according to different applications.  Propagation Components The propagation components take the structure of the movement model into consideration to capture the overall trend of movement behaviors between an OD-pair. The basic idea is to disseminate DoI value of a certain node and the DoI values of its surrounding nodes decrease correspondingly. The propagation components can be deﬁned by the following elements:• The DoI value of the selected node X : doi(X ) which is to be propagated.• The distance function dist(X,Y ) takes the selected node X and another node Y ∈ V  as an input and calculates the sum of weights of the shortest path between them based on theconstructed movement model G to measure how far these two nodes are separated from each other.• The propagation function prop(doi(X ), dist(X,Y )) which is monotonic decreasing, so that the inﬂuence of the selectednode X to the node Y recedes with the increasing distance between them. In this work, we deﬁne the propagation func- tion based on Gaussian kernel:dist(X,Y )2• 
Check these nodes one by one whether it is the only remaining node on a trajectory: If yes, move it from set R to set S; Otherwise, remove it from set R;6) Repeat Step 4 to 6 until set R is empty. The nodes in set Sare the key nodes we extracted.  Compared with other common extraction methods like ﬁltering based on a certain attribute (e.g. hotness), our method can not only capture the skeleton of the route structure for a node-pair shown in the OD-pair Flow View (Section V-B), but also identify the important regions with interesting micro patterns which will be depicted in the Isotime Storyline View (Section V-C).V. VISUALIZATION  DESIGNA. Global View  In this  section,  we  describe  the  design  of  the  Global  View. It presents an overall distribution of OD-pairs extracted from trajectories, which serves as a guiding map for further exploration. To avoid visual clutter and provide information at different levels of detail, we adopt an interactive visualization framework with a two-layer encoding scheme as shown in Fig. 2.
prop(doi(X ), dist(X,Y )) = doi(X ) · exp(−
2σ 2	)
where σ determines the width of the propagation.  These elements are then combined to update the DoI value of the node Y:doil(Y )= MAX {doi(Y ) − prop(doi(X ), dist(X,Y )), 0}.
C. Key Node Extraction  The movement model in the graph-structure (Section IV-A) serves as a reference which summarizes the bi-directional move- ment between OD-pairs (T.1). However, visualizing such a move- ment model still faces the challenge of scalability with respect to the number and distribution of nodes in the model. Moreover, branchings and zig-zags of the trajectories could make it hard to read the routes between OD-pairs (T.2, T.3) and could incur visual clutter for the detection of meaningful micro patterns (T.4, T.5). In order to make the visualization effective, a trade-off should be made between two general criteria: the simplicity and the preservation of original patterns. Therefore, it is desirable to extract key nodes based on the DoI from the constructed movement model to suppress less important details. Given the constructed movement model G = (V, E) and a certain OD-pair, the following steps are implemented to extract key nodes:1) Initialize two sets R (for remaining nodes with positive DoI values) and S (for selected key nodes): R = V , S = 0/ ;2) Compute the DoI values of each node in set R and sort them according to their corresponding DoI values.3) Find the node with the highest value and move it from set Rto set S as a selected key node;4) Calculate the length of the shortest path from the selected node in the previous step to each node in set R and update its corresponding DoI value through the propagation function;5) For all the nodes with DoI values of zero in set R:• Sort those nodes in ascending order according to their DoI values before propagation (step 4)
Figure 2: Global View: The heatmap layer shows locations with frequent movement in darker red. After a location of interest is chosen (blue marker), the OD-pair layer is activated to highlight locations of all related OD-pairs with nodes. Locations with more bi-directional movement are indicated by larger nodes. Then the other location can be chosen (red marker) to generate the OD-pair Flow View for further exploration.  Heat Map Layer First, we identify hot spots with frequent movement behaviors. We rasterize the map into pixels and count the total number of departing and arriving trajectories for each pixel. Then we use the heat map to reveal the hotness (i.e. the total number of trajectories) of different locations. Through rich interactions, users can zoom, move and select interesting locations for further exploration.  OD-pair Layer After users choose one location A of interest in the heat map layer (blue marker in Fig. 2), based on the constructed movement model, all nodes of related OD-pairs will be highlighted in the OD-pair layer. The size of the nodes encodes the frequency of movement from or to the chosen location A (i.e. the total number of trajectories to/from A). Based on this, users can choose the other location of OD-pair (red marker in Fig. 2) to activate the OD-pair Flow View. To reduce overlapping of nodes, we further employ a force-directed layout similar to Liu et al.’s work [13] and enable ﬁltering based on frequency.
Figure 3: OD-pair Flow View: (a) Blue ﬂows represent routes in forward direction (i.e. from A to B) while red ﬂows represent routes in reversed direction (i.e. from B to A). The width of the ﬂow is proportional to the number of trajectories along the route, indicating the route’s popularity. (b) Key nodes are plotted as grey points with height showing the hotness of the node. (c) Two groups of vertical axes allow users to brush to choose routes of attributes within a certain range in two directions. (d) Two horizontal axes, called progress axes, show the journey progress in two directions symmetrically from 0% to 100%.
B. OD-pair Flow View  The OD-pair Flow View is designed to visualize and facilitate the analysis of macro patterns in spatial, temporal and mobility- related factors of bi-directional movement behaviors along different routes between the chosen OD-pair (i.e. location A and B).  Design Rationale Analyzing patterns along different routes be- tween a certain OD-pair is a common and important analytical task for movement analysis in many practical applications. Therefore, it is desirable to provide a view that can clearly show the topology of all routes of bi-directional movement behaviors (T.2), reveal macro patterns and facilitate comparisons between different routes with respect to spatial, temporal and mobility-related factors (T.3).  For the design of this view, we follow basic design principles of visualization [24], [32], [33], including legibility, aesthetics and neatness. A ﬂow map is preferably used to show moving ﬂows between two locations [3] in the geo-space. However, if all details of the moving ﬂows, such as routes and mobility-related factors, are plotted on the map, the display will be visually cluttered and users can hardly identify any patterns, especially when there are numerous routes and directions need to be differentiated. In order to present clear routes and investigate patterns along different routes and directions, we extract key nodes based on DoI deﬁnition as described in Section  IV.  With  these  extracted  key  nodes, we propose OD-pair Flow View, which is a novel visualization strategy that presents routes between an OD-pair in a parallel fashion embedded with parallel coordinates. In consideration of aesthetics and neatness, the symmetric design is adopted to present information in an organized manner, which can be perceived much more strongly by users according to the previous research [34].  Visual Encoding Schemes Fig. 3 shows the OD-pair Flow View. The followings elaborate its construction procedure:    Parallel route model: First, we arrange two horizontal axes, called progress axes, on the top and bottom of the view to show the journey progress in two directions symmetrically from 0% to 100% (left to right for A to B, while right to left for B to A). Meanwhile, two groups of vertical axes are further embedded at two sides of the
view, which forms a parallel-coordinates-style chart. Each group consists of three axes, namely length axis, average time axis and time variance axis, which are used to indicate different attributes of the routes intuitively and sort them accordingly to generate a ﬂow map in a parallel fashion. To further facilitate visual examination, an array of vertical grey lines and an array of horizontal grey lines can be activated respectively based on user’s conﬁguration.    Key node layout: To present routes between location A and B, we organize each route as a sequence of extracted key nodes. The length of each route can be computed by summing up the weights of edges in between as described in Section IV. Then, for each key node N, the vertical coordinate is determined by the length LN of the shortest route passing through it, and the horizontal coordinate is calculated by its relative position (i.e. journey progress) PN % (or(1 − PN %)) along the shortest route from A to B (from B to A). Inaddition, the total number of trajectories passing through the nodeis counted to decide its height.    Flow encoding: After positioning all the key nodes in the view, we present routes in a graph structure via connecting the nodes of each route by a stroke to form a clear and smooth ﬂow. In order to encode macro patterns of movement behaviors along each route, we take full advantage of visual channels. First, we split each ﬂow of a route into two sub-ﬂows and use contrasting colors, red and blue, to represent movement in two directions respectively. In addition, the width of each ﬂow is proportional to the number of trajectories along each route, which helps to identify the popularity of the route. Note also that to deal with overlaps caused by crossings of ﬂows, transparency is utilized to help users follow a ﬂow at crossing points.    Flow routing: In addition to connecting key nodes sequen- tially by ﬂows to represent different routes, each ﬂow is further extended to vertical axes at two sides to indicate different attributes of the route. In line with the neatness principle, we connect sub- ﬂows of A to B to the left axes, and connect sub-ﬂows of B to A to the right axes. However, neighboring ﬂows with large width, corresponding to routes with similar lengths (even same lengths) and high popularity, may still overlap when connecting to vertical
Figure 4: Isotime Storyline View: (a) Bi-directional storyline chart: the blue and red storylines depict individuals’ movement behaviors in two directions repectively. Two lines corresponding to the same individual’s consecutive movement in two directions are connected by an arc at the right end of the chart. Points in distinct colors along each line indicate when (arrival time as horizontal coordinate) and how (speed as vertical coordinate) the individual passes through different key nodes. (b) Contour map: provides a visual abstraction of aggregated patterns of individuals’ movement behaviors at each key node. The clusters of similar movement behavior are indicated by more shaded regions. (c) Isotime curve: connects the average arrival time at each key node in two directions. (d) Multi-faceted ﬁlters: support ﬁltering by time and mobility-related factors through two linked histograms and a line chart. (e) Multi-lane layout: eliminates the overlaps of contour maps. (f) Overlaps of contour maps before applying multi-lane layout.
axes. To resolve this issue, we use a heuristic layout optimization algorithm which tries to eliminate overlaps as well as minimize vertical location changes of ﬂows. Once overlapping is detected, we extend each ﬂow along the vertical axis through Bezier curves to next available positions.C. Isotime Storyline View  In this section, we introduce the Isotime Storyline View which is designed to show and compare individuals’ behaviors of bi- directional movement along a certain route between a chosen OD- pair (i.e. location A and B).  Design Rationale To support a comprehensive analysis based on the identiﬁed analytical tasks (T.4, T.5), our system is required to keep small features visible within context to reveal details of individuals’ behaviors, so as not to neglect outliers and to deal with different analysis granularities.  We’ve considered a few alternative designs. Firstly, the ﬂows along a speciﬁc route in the  OD-pair  Flow  View  can  be  split into multiple sub-ﬂows, one for each individual. However, it is hard to present individuals’ behaviors clearly along those  sub- ﬂows for examination (T.4) and comparison (T.5), especially when there are numerous individuals. Moreover, storyline visualization is commonly used to reveal entity relationships, but it is hard to simultaneously depict movement in two directions. Ultimately, we come up with a composite visual design as follows: individuals’ movement behaviors in two directions are encoded using bi- directional storylines enhanced with isotime curves to facilitate clear comparisons (T.5), while contour maps are integrated to present aggregated information for a better understanding of in- dividuals’ movement behaviors within context (T.4).  Visual Encoding Schemes As illustrated in Fig. 4, we design an interactive view integrating several visualization techniques.    Bi-directional storyline: We propose a bi-directional storyline chart (Fig. 4a) to convey temporal patterns and compare bi- directional movement behaviors of individuals. First, two horizontal
time axes are embedded in the view. The top axis represents time progressing from left to right for the movement from A to B, while the bottom one represents time progressing from right to left for the inverse movement (i.e. from B to A). Then we divide the chart into upper and lower parts. The vertical space of two parts is symmetrically used to depict mobility-related factors (e.g. speed in our case studies). After that, for the movement of an individual from A to B (from B to A), we plot points in distinct colors in upper part (lower part) indicating different key nodes. The positions of these points are determined by when (i.e. arrival time) and how (i.e. speed) the individual passes through the corresponding key nodes. And these points are connected sequentially through a blue (red) line. Further, the two lines corresponding to the same individual’s consecutive movement in two directions are connected by an arc at the right end of the chart. In this way, individuals’ movement can be presented as a series of lines and the vertical proximity of the lines offers an intuitive method to compare the movement behaviors of individuals based on temporal and mobility-related factors at certain key nodes along the route. To reduce the crossings of arcs when connecting lines in two directions and allow users to investigate the rankings of individuals, we sort the lines in two parts symmetrically by their time spent on account of the coherence of an individual’s movement behavior in two directions. Meanwhile, compared with line interpolation strategies such as orthogonal lines and straight lines, we adopt cubic Bezier curves which are easy to follow particularly for line crossings [19] and enjoy high preference ratings according to feedbacks from our collaborators.    Contour map with isotime curve: Contour maps (Fig. 4b) are generated to depict aggregated patterns at different key nodes. Based on the plotted points along lines for each key node, kernel density estimation is applied, and isocontours are traced by follow- ing points of the same density. The contours are then ﬁlled with transparent color and the additive blending effect creates regions that  are  more  shaded  indicating  clusters  of  similar  movement
behaviors at the key node. To further facilitate the comparison of bi-directional movement behaviors, we plot a series of isotime curves to connect the average arrival time at each key node in two directions (Fig. 4c).    Multi-faceted ﬁlters: We provide multi-faceted ﬁlters (Fig. 4d) to support dynamic queries on storylines. First, two interactive histograms show the temporal distribution of movement behaviors in two directions to facilitate ﬁltering by time. Two histograms are further linked to show the statistics of movement conducted by the same individuals during different time spans. In addition, we also support ﬁltering by mobility-related factors (e.g. time spent) through a line chart.    Dealing with visual clutters: As the temporal distribution of movement may be uneven, overlaps of contour maps for different nodes will lead to visual clutters. To deal with this problem, we can implement a bounding box for each contour map and enable users to expand interactively, but this requires heavy interactions and makes the analysis process inefﬁcient. Thus, in our system, a multi-lane layout method [35] is adopted which can eliminate potential overlaps while preserving the compactness (Fig. 4e).D. Interactions  Our system provides users with rich interactions to facilitate an efﬁcient analysis. Besides typical user interactions like ﬁltering and brushing, following interactions are also supported:  Linking The system supports automatic linking among different views. For example, if users select a node or a route in the OD-pair Flow View, the corresponding region or route will be shown within geographical context in the Global View, and the Isotime Storyline View will be updated accordingly.  Highlighting Highlighting is enabled to facilitate intuitive explorations. For instance, in the Isotime Storyline View, users can double click on a storyline, and then all the storylines correspond- ing to the same individual will be highlighted. This helps to reduce visual burden and allows users to easily observe behaviors of a certain individual and to make intuitive comparisons.VI. CASE  STUDIES  Our system is implemented using JavaScript, and the data is pro- cessed using a MapReduce system. After the data modeling phase, the system can support real-time interactions. In the following, we demonstrate our system through two use cases: taxi travel in urban area and vulture migration.Figure 5: The OD-pair Flow View for taxi travel between Jing’an Temple and Lujiazui in Shanghai during Dec. 1st to 7th, 2007. Three major bi-directional routes are labeled with I, II and III.A. Case Study 1: Taxi Travel in Urban Area  In the ﬁrst case study, we apply our system on the trajectory data of ten thousands taxis collected in Shanghai, China for a time span during Dec. 1st  to 7th, 2007. To analyze the bi-directional
movement behaviors of taxis, we ﬁrst generate an overview of the data to guide further exploration (T.1). By observing the heat map layer in Fig. 2, users can ﬁnd out regions with frequent bi- directional movement marked in darker color. Most of the regions covered by darker colors are around the city center. We zoom in and click on Jin’an Temple (blue marker in Fig. 2), an old residential area in the center of Shanghai, and then corresponding regions of all related OD-pairs are highlighted with nodes. We ﬁnd a large number of highlighted nodes on the map, which indicates that people in many other regions take taxis to or from Jin’an Temple. Then we choose another node of larger size, corresponding to Lujiazui (red marker in Fig. 2), a metropolitan transportation hub and central business district in Pudong New Area of Shanghai.  As shown in Fig. 5, the OD-pair Flow View is activated, where we can see that there are three major bi-directional routes between Jin’an Temple and Lujiazui marked with I, II and III respectively (T.2). Route I and II are obviously shorter than route III as indicated on the length axes. By observing the width of the ﬂow, we ﬁnd most taxis choose route II, although the length of route I is shorter. Further more, as indicated on the time variance axes, the variance of time spent along route II is much higher, which implies unstable trafﬁc conditions along the route. For route III, its length is far longer than that of the other two, but it has the shortest time spent, implying a better trafﬁc condition along this route (T.3). Based on these observations, our domain experts in transportation industry further identify that most taxis choose route II mainly due to taxi drivers’ preference to elevated road, while route III is chosen when people want to avoid trafﬁc jams in trade off a long distance.Figure 6: The Isotime Storyline View for route II of taxi travel between Jing’an Temple and Lujiazui in Shanghai during 8 - 10 am of weekdays.  Then we pick route II, the most popular one, to further explore micro patterns. Our expert is more interested in patterns during peak hours of weekdays, which is a major concern of most trans- portation studies. We do ﬁltering on the control panel focusing on time period during 8 - 10 am from Monday to Friday, and generate visualization in the Isotime Storyline View (Fig. 6). We can see that during this period, it takes more time to travel from Jin’an Temple to Lujiazui (blue storylines) compared to the other direction (red storylines) (T.5). And the major difference of time spent is on the third segment which is  indicted  by  the  different  upper and lower areas between grey and pink isotime curves (marked by black rectangles in Fig. 6). In addition, the ﬂat pink contour (highlighted with  a black arrow in  Fig.  6)  indicates  consistent but slow driving speeds of  taxis likely caused by  trafﬁc jams. Furthermore, based on interactions of our system, we identify the pink contour corresponding to the Yan An Road Vehicular Tunnel,
which is a bottleneck connecting Puxi and Pudong in Shanghai. Our domain experts further conclude that more people may commute from Jin’an Temple to Lujiazui by taxis in the morning because many companies set up their ofﬁces there.  In addition, we also analyze micro patterns along route III. From the histograms of the multi-faceted ﬁlters (Fig. 4d), we can see that trips along this route usually happen during rush hours, which veriﬁes our hypothesis on people choosing route III to avoid trafﬁc jams. An outlier is also identiﬁed (marked with a black arrow in Fig. 4), which is a speeding case during midnight (T.4).B. Case Study 2: Vulture Migration  In this case study, we analyze bi-directional migration patterns of turkey vultures in North America. The dataset is from related studies in Movebank [36] [37], containing migration records of 51 satellite-tracked vultures of different ﬂocks for about 10 years.Figure 7: The Global View for vulture migration shows the habitats of vultures in red. An OD-pair (i.e. Guatemala and Canada) is chosen for further exploration, indicated by blue and red markers.  In the Global View, we can see that  there  are  several  dark areas on the heat map (Fig. 7) (T.1). These areas are habitats of vultures during non-migratory seasons. The geographically isolated habitats indicate that turkey vultures are widely distributed and may have strong ability to adapt to environments. We pick an area in Guatemala (blue marker in Fig. 7), then two clusters of regions, indicating two major migrating destinations, are highlighted with nodes. We click on a node with a larger size located on the border between USA and Canada (red marker in Fig. 7) and activate the OD-pair Flow View (Fig. 3).  First, in the left part of Fig. 3, we can see all routes merge into the same nodes (T.2). In accordance to related studies [37], this is because of the hourglass shape of North American (i.e. Mesoamerican). Birds are traveling along mountains, which leads to the longitudinal thinning in the migration corridor. After that, we can see there is one ﬂow of large width at the bottom of the view, indicating one major bi-directional route between this OD-pair. It seems that birds tend to choose the migration route with shortest distance. In addition, as shown on the time variance axes of the parallel coordinates (marked with black rectangles in Fig. 3), the time spent for migration starting from Canada (called outbound migration [37]) has larger variation than that from Guatemala (called return migration [37]) (T.3). The explanation includes the fact  that  outbound  migration  happens  after  breeding  season  of
(a)(b)Figure 8: The Isotime Storyline View for vulture migration: (a) A vulture (namely Steamhouse II) whose migration pattern matches the general migration pattern by related studies [37]. (b) A vulture (namely Leo) with different migration behaviors.potential prey, which provides more food for turkey vultures during their migration.  Then, we click to explore detailed micro patterns along this major migration route in the Isotime Storyline View. There are ﬁve vultures ever migrated along this route. Based on our system, we track individual migration behaviors (T.4) by ﬁltering on bird IDs. Surprisingly, we ﬁnd not all vultures migrate following the general migration pattern as indicated in the related study paper [37] (i.e. the outbound migration, corresponding to red storylines, takes more time than the return migration, corresponding to blue storylines, but varies a lot from year to year and ﬂock to ﬂock). In Fig. 8a, we show the view of a vulture (namely Steamhouse II) where red storylines are generally longer than blue storylines but with higher diversity, which matches with the general migration pattern. In contrast, Fig. 8b shows a quite different migration pattern of another vulture (namely Leo) whose outbound migration takes similar time to the return migration. By hovering on a storyline, we even ﬁnd that Leo took longer time for the return migration in 2009 and 2011 (i.e. blue storylines are longer).VII. EXPERT  INTERVIEW  To further evaluate our system, we  presented  the  workﬂow and demonstrated the case studies to three domain experts and conducted interviews with them to collect their feedbacks. One of them is from University B (Expert A) specialized in trajectory data analysis, while the other two (Expert B and C) from a planning and development department of a public transportation agency in Hong Kong. Their feedbacks are summarized as follows:
  Interactive Visual Design All domain experts were impressed by the visual design of our system, especially the Isotime Storyline View. Expert B commented “It is an excellent idea to visualize and explore bi-directional movement behaviors in three levels, which can help reveal hidden patterns intuitively and enhance users’ understanding”. Expert C added “After the brief introduction, I acknowledge the effectiveness of presenting individuals’ behaviors as lines with aggregated information as contour maps. I appre- ciate this design, and the ﬁndings in your case studies are quite interesting”. Further, Expert A highlighted that the adoption of the modular DoI speciﬁcation was a new expressive description for movement analysis which helped to extract interesting patterns in bi-directional movement and simpliﬁed the analysis  process with appropriate ﬂexibility. He considered this method could even be extended to other studies on movement data. Meanwhile, the interactive features of our system are also well received. All domain experts believed  that  the interactive  analysis  and  the ability  to switch between different views are conducive to and intuitive for a comprehensive analysis.  Applicability  Expert B commented “The system can be used to support the recommendation of public transportation”. As shown in Case Study 1, based on the OD-pair Flow View, the system allows users to evaluate routes between an OD-pair by comparing their popularity, length, and average time spent. He also suggested “With access to real time data, this system has a great potential to be applied to monitor the operating status of bus lines in the city”. Improvements   The domain experts gave valuable feedbacks   to improve our system. Expert A said that “The visualization is good at enabling qualitative analysis. It is desirable to support more quantitative analysis based on advanced data mining techniques.” In addition, Expert C also highlighted that the major challenge in understanding the storyline view is mainly caused by a multi-lane layout algorithm which puts different nodes into several lanes to avoid overlapping. Although he agreed that it is understandable, he suggested to provide options for users to deactivate the layout algorithm through conﬁguration, which has been incorporated inour current system.VIII. DISCUSSION  The case studies demonstrate the effectiveness of our system to analyze bi-directional movement behaviors from different aspects and at different scales. With our system, users can detect macro (i.e. characteristics of OD-pairs and routes) and micro (i.e. individual’s behaviors) patterns intuitively.  Our research is still in progress. Weaknesses have been observed and will be addressed in the  future.  First,  the  proposed  OD- pair Flow View and Isotime Storyline View will suffer scalability problems, if the number of individuals or the routes  becomes large. This is common for all work based on ﬂow or storyline visualization. To mitigate this problem, we have integrated multiple ﬁltering strategies to reduce the number of data items to be displayed. In addition, clustering or edge bundling methods can be exploited. Further, as we use colors to encode different key nodes along the route, the number of nodes which can be shown in the storyline view is limited. In order to visualize a long route with a large number of extracted key nodes, we can either adjust parameters of the propagation components in the movement model
to ﬁlter out less important nodes, or cluster nodes into different groups and display them with levels of detail.  Secondly, we adopt a multi-lane layout algorithm to deal with potential overlaps of contour maps. The layout algorithm works well in general cases, but may fail to create an effective layout in some extreme cases where the arriving time at multiple key nodes varies a lot, leading to a large number of lanes. In this case, there would be a signiﬁcant amount of clutter caused by crossings between storylines in different lanes. To implement a bounding box for each node and enable users to expand interactively would be helpful in this scenario. Nevertheless, we believe that the multi-lane layout algorithm works well for most scenarios of bi-directional movement, and it also makes the outlier detection more intuitive. Finally, our movement model deﬁnes DoI from three aspects, in- cluding spatial, temporal and mobility-related factors. For practical applications, other attributes may also need to be considered. We will pursue more analysis and exploration of general bi-directional movement behaviors based on advanced data mining techniques tofurther improve our work.IX. CONCLUSION  AND  FUTURE  WORK  In this paper, we have presented a visual analytics system to investigate bi-directional movement behaviors. A movement model with modular DoI speciﬁcation is ﬁrst constructed to model the bi- directional movement. Then, we propose several novel visualization designs such as OD-pair Flow View to detect macro  patterns along different routes and navigate further exploration, Isotime Storyline View to reveal micro patterns of individuals’ behaviors. Advanced visual analytics techniques combined with intuitive user interactions allow users to interactively explore and analyze bi- directional movement behaviors comprehensively. Our method has a wide range of applications and can be used to analyze athletes’ performance, signal propagation etc.  There are multiple venues for future work. We plan to improve the movement model and DoI speciﬁcation to support more ana- lytical tasks. As suggested by our domain experts, an interesting direction will be to extend our system to support analysis of real time movement data (e.g. trafﬁc monitoring data). In addition, we plan to test our system on datasets in other application domains and conduct controlled experiments to get more feedbacks from end users for further improvements.ACKNOWLEDGMENT  The authors thank the anonymous reviewers for their valuable comments. This research was supported in part by HK RGC GRF 16208514, the National Basic Research Program of China (973 Program) under Grant No. 2014CB340304, a grant from Noahs Ark Lab, Huawei Technologies Investment Co. Ltd, and a grant from Microsoft Research Asia.REFERENCES[1] G. Andrienko, N. Andrienko, P. Bak, D. Keim, and S. Wrobel, Visual analytics of movement. Springer Publishing Company, Incorporated, 2013.[2] J. Corbett, “Charles josephminard: Mapping Napoleon’s march, 1861,” 2012.[3] D. Guo and X. Zhu, “Origin-destination ﬂow data smoothing and mapping,” Visualization and Computer Graphics, IEEE Transac- tions on, vol. 20, no. 12, pp. 2043–2052, 2014.
[4] N. Ferreira, L. Lins, D. Fink, S. Kelling, C. Wood, J. Freire, andC. Silva, “Birdvis: Visualizing and understanding bird popula- tions,” Visualization and Computer Graphics, IEEE Transactions on, vol. 17, no. 12, pp. 2374–2383, 2011.[5] T. Crnovrsanin, C. Muelder, C. Correa, and K.-L. Ma, “Proximity- based visualization of movement trace data,” in Visual Analytics Science and Technology, 2009. VAST 2009. IEEE Symposium on. IEEE, 2009, pp. 11–18.[6]  G.  Andrienko,  N.  Andrienko,  J.  Dykes,  S.  I.  Fabrikant,  andM. Wachowicz, “Geovisualization of dynamics, movement and change: Key issues and developing approaches in visualization research.” Information Visualization, vol. 7, no. 3-4, pp. 173–180, 2008.[7] H. Guo, Z. Wang, B. Yu, H. Zhao, and X. Yuan, “Tripvista: Triple perspective visual trajectory analytics and its application on microscopic trafﬁc data at a road intersection,” in Paciﬁc Visualization Symposium (PaciﬁcVis), 2011 IEEE. IEEE, 2011, pp. 163–170.[8] C. Tominski, H. Schumann, G. Andrienko, and N. Andrienko, “Stacking-based visualization of trajectory attribute data,” Visual- ization and Computer Graphics, IEEE Transactions on, vol. 18, no. 12, pp. 2565–2574, 2012.[9] T. Kapler and W. Wright, “Geotime information visualization,”Information Visualization, vol. 4, no. 2, pp. 136–146, 2005.[10] Z. Wang and X. Yuan, “Urban trajectory timeline visualization,” in Big Data and Smart Computing (BIGCOMP), 2014 Interna- tional Conference on.   IEEE, Jan 2014, pp. 13–18.[11] W. Zeng, C.-W. Fu, S. Arisona, A. Erath, and H. Qu, “Visualiz- ing mobility of public transportation system,” Visualization and Computer Graphics, IEEE Transactions on, vol. 20, no. 12, pp. 1833–1842, Dec 2014.[12] N. Willems, H. Van De Wetering, and J. J. Van Wijk, “Evaluation of the visibility of vessel movement features in trajectory visual- izations,” in Computer Graphics Forum, vol. 30, no. 3. Wiley Online Library, 2011, pp. 801–810.[13] H. Liu, Y. Gao, L. Lu, S. Liu, H. Qu, and L. M. Ni, “Visual analysis of route diversity,” in Visual Analytics Science and Technology (VAST), 2011 IEEE Conference on.  IEEE, 2011, pp. 171–180.[14] R. Scheepens, H. Van De Wetering, and J. van Wijk, “Non- overlapping aggregated multivariate glyphs for moving objects,” in Paciﬁc Visualization Symposium (PaciﬁcVis), 2014 IEEE. IEEE, March 2014, pp. 17–24.[15] W. Wu, Y. Zheng,  H.  Qu,  W.  Chen,  E.  Groeller,  and  L.  M. Ni, “Boundaryseer:  Visual analysis  of 2d  boundary changes,” in Visual Analytics Science and Technology (VAST), 2014 IEEE Conference on.   IEEE, 2014, pp. 143–152.[16] W. Zeng, C.-W.  Fu, S. M. Arisona, and  H. Qu, “Visualizing interchange patterns in massive movement data,” in Computer Graphics Forum, vol. 32, no. 3pt3. Wiley Online Library, 2013, pp. 271–280.[17] N. Andrienko, G. Andrienko, L. Barrett, M. Dostie, and P. Henzi, “Space transformation for understanding group movement,” Visu- alization and Computer Graphics, IEEE Transactions on, vol. 19, no. 12, pp. 2169–2178, 2013.[18] R. Munroe, “Movie narrative charts,” http://xkcd.com/657/, Dec 2009.[19] N. W. Kim, S. K. Card, and J. Heer, “Tracing genealogical data with timenets,” in Proceedings of the International Conference on Advanced Visual Interfaces.   ACM, 2010, pp. 241–248.[20]  K.  Reda,  C.  Tantipathananandh,  A.  Johnson,  J.  Leigh,  andT. Berger-Wolf, “Visualizing the evolution of community struc- tures in dynamic social networks,” in Computer Graphics Forum,   
vol. 30, no. 3.   Wiley Online Library, 2011, pp. 1061–1070. [21]  W. Cui, S. Liu, L. Tan, C. Shi, Y. Song, Z. Gao, H. Qu, andX. Tong, “Textﬂow: Towards better understanding of evolving topics in text,” Visualization and Computer Graphics, IEEE Transactions on, vol. 17, no. 12, pp. 2412–2421, 2011.[22] M. Krstajic, M. Najm-Araghi, F. Mansmann, and D. A. Keim, “Incremental visual text analytics of news story development,” in IS&T/SPIE Electronic Imaging. International Society for Optics and Photonics, 2012, pp. 829 407–829 407.[23] M. Ogawa and K.-L. Ma, “Software evolution storylines,” in Proceedings of the 5th international symposium on Software visualization.   ACM, 2010, pp. 35–42.[24] Y. Tanahashi and K.-L. Ma, “Design considerations for optimizing storyline visualizations,” Visualization and Computer Graphics, IEEE Transactions on, vol. 18, no. 12, pp. 2679–2688, 2012.[25] S. Liu, Y. Wu, E. Wei, M. Liu, and Y. Liu, “Storyﬂow: Tracking the evolution of stories,” Visualization and Computer Graphics, IEEE Transactions on, vol. 19, no. 12, pp. 2436–2445, 2013.[26] G. W. Furnas, “Generalized ﬁsheye views,” in Proceedings of the SIGCHI Conference on Human Factors in Computing Systems, ser. CHI ’86.    New York, NY, USA: ACM, 1986, pp. 16–23.    [Online]. Available: http://doi.acm.org/10.1145/22627.22342 [27]  P. Hu¨sken and J. Ziegler, “Degree-of-interest visualization for on-tology exploration,” in Human-Computer Interaction–INTERACT 2007.   Springer, 2007, pp. 116–119.[28] F. Van Ham and A. Perer, “”search, show context, expand on demand”: Supporting large graph exploration with degree-of- interest,” Visualization and Computer Graphics, IEEE Transac- tions on, vol. 15, no. 6, pp. 953–960, 2009.[29] J. Abello, S. Hadlak, H. Schumann, and H.-J. Schulz, “A modular degree-of-interest speciﬁcation for the visual analysis of large dynamic networks,” Visualization and Computer Graphics, IEEE Transactions on, vol. 20, no. 3, pp. 337–350, March 2014.[30] B. Shneiderman, “The eyes have it: A task by data type taxon- omy for information visualizations,” in Visual Languages, 1996. Proceedings., IEEE Symposium on.   IEEE, 1996, pp. 336–343.[31] N. Adrienko and G. Adrienko, “Spatial generalization and aggre- gation of massive movement data,” Visualization and Computer Graphics, IEEE Transactions on, vol. 17, no. 2, pp. 205–219, 2011.[32] L. Byron and M. Wattenberg, “Stacked graphs–geometry & aesthetics,” Visualization and Computer Graphics, IEEE Trans- actions on, vol. 14, no. 6, pp. 1245–1252, 2008.[33] C. Shi, Y. Wu, S. Liu, H. Zhou, and H. Qu, “Loyaltracker: Visualizing loyalty dynamics in search engines,” Visualization and Computer Graphics, IEEE Transactions on, vol. 20, no. 12, pp. 1733–1742, 2014.[34] C. Ware, Information visualization: perception for design. El- sevier, 2012.[35] C. Xie, W. Chen, X. Huang, Y. Hu, S. Barlowe, and J. Yang, “Vaet: A visual analytics approach for e-transactions time-series,” Visualization and Computer Graphics, IEEE  Transactions  on, vol. 20, no. 12, pp. 1743–1752, 2014.[36] “Environmental drivers of variability in the movement ecology of turkey vultures (cathartes aura) in north and south america,” https://www.datarepository.movebank.org/handle/10255/move.362, 2014.[37] S. Dodge, G. Bohrer, K. Bildstein, S. C. Davidson, R. Weinzierl,M. J. Bechard, D. Barber, R. Kays, D. Brandes, J. Han et al., “Environmental drivers of variability in the movement ecology of turkey vultures (cathartes aura) in north and south america,” Philosophical Transactions of the Royal Society of London B: Biological Sciences, vol. 369, no. 1643, p. 20130195, 2014.